!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).webgpuMemory={})}(this,(function(e){"use strict";function t(e){return[...Object.keys(e)]}const o={blockWidth:void 0,blockHeight:void 0,color:void 0,depth:void 0,stencil:void 0,colorRender:void 0,multisample:void 0,feature:void 0,baseFormat:void 0,bytesPerBlock:void 0};function r({defaults:e,table:t}){return Object.fromEntries(Object.entries(t).map((([t,r])=>[t,{...o,...e,...r}])))}const s=r({defaults:{blockWidth:1,blockHeight:1},table:{r8unorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:1},colorRender:{blend:!0,resolve:!0,byteCost:1,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},r8snorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:1},multisample:!1,get bytesPerBlock(){return this.color.bytes}},r8uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:1},colorRender:{blend:!1,resolve:!1,byteCost:1,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},r8sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:1},colorRender:{blend:!1,resolve:!1,byteCost:1,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg8unorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},colorRender:{blend:!0,resolve:!0,byteCost:2,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg8snorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rg8uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},colorRender:{blend:!1,resolve:!1,byteCost:2,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg8sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},colorRender:{blend:!1,resolve:!1,byteCost:2,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rgba8unorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:4},colorRender:{blend:!0,resolve:!0,byteCost:8,alignment:1},multisample:!0,baseFormat:"rgba8unorm",get bytesPerBlock(){return this.color.bytes}},"rgba8unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!0,resolve:!0,byteCost:8,alignment:1},multisample:!0,baseFormat:"rgba8unorm",get bytesPerBlock(){return this.color.bytes}},rgba8snorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rgba8uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:4,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rgba8sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:4,alignment:1},multisample:!0,get bytesPerBlock(){return this.color.bytes}},bgra8unorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!0,resolve:!0,byteCost:8,alignment:1},multisample:!0,baseFormat:"bgra8unorm",get bytesPerBlock(){return this.color.bytes}},"bgra8unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!0,resolve:!0,byteCost:8,alignment:1},multisample:!0,baseFormat:"bgra8unorm",get bytesPerBlock(){return this.color.bytes}},r16uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},colorRender:{blend:!1,resolve:!1,byteCost:2,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},r16sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},colorRender:{blend:!1,resolve:!1,byteCost:2,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},r16float:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},colorRender:{blend:!0,resolve:!0,byteCost:2,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg16uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:4,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg16sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:4,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg16float:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!0,resolve:!0,byteCost:4,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rgba16uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:8},colorRender:{blend:!1,resolve:!1,byteCost:8,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rgba16sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:8},colorRender:{blend:!1,resolve:!1,byteCost:8,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rgba16float:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:8},colorRender:{blend:!0,resolve:!0,byteCost:8,alignment:2},multisample:!0,get bytesPerBlock(){return this.color.bytes}},r32uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!0,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:4,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},r32sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!0,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:4,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},r32float:{color:{type:"unfilterable-float",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!0,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:4,alignment:4},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg32uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:8},colorRender:{blend:!1,resolve:!1,byteCost:8,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rg32sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:8},colorRender:{blend:!1,resolve:!1,byteCost:8,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rg32float:{color:{type:"unfilterable-float",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:8},colorRender:{blend:!1,resolve:!1,byteCost:8,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rgba32uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:16},colorRender:{blend:!1,resolve:!1,byteCost:16,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rgba32sint:{color:{type:"sint",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:16},colorRender:{blend:!1,resolve:!1,byteCost:16,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rgba32float:{color:{type:"unfilterable-float",copySrc:!0,copyDst:!0,storage:!0,readWriteStorage:!1,bytes:16},colorRender:{blend:!1,resolve:!1,byteCost:16,alignment:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}},rgb10a2uint:{color:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!1,resolve:!1,byteCost:8,alignment:4},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rgb10a2unorm:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!0,resolve:!0,byteCost:8,alignment:4},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rg11b10ufloat:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},colorRender:{blend:!0,resolve:!0,byteCost:8,alignment:4},multisample:!0,get bytesPerBlock(){return this.color.bytes}},rgb9e5ufloat:{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:4},multisample:!1,get bytesPerBlock(){return this.color.bytes}}}}),c=r({defaults:{blockWidth:1,blockHeight:1,multisample:!0},table:{stencil8:{stencil:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:1},bytesPerBlock:1},depth16unorm:{depth:{type:"depth",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:2},bytesPerBlock:2},depth32float:{depth:{type:"depth",copySrc:!0,copyDst:!1,storage:!1,readWriteStorage:!1,bytes:4},bytesPerBlock:4}}}),a=r({defaults:{blockWidth:1,blockHeight:1,multisample:!0},table:{depth24plus:{depth:{type:"depth",copySrc:!1,copyDst:!1,storage:!1,readWriteStorage:!1,bytes:void 0},bytesPerBlock:4},"depth24plus-stencil8":{depth:{type:"depth",copySrc:!1,copyDst:!1,storage:!1,readWriteStorage:!1,bytes:void 0},stencil:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:1},bytesPerBlock:4},"depth32float-stencil8":{depth:{type:"depth",copySrc:!0,copyDst:!1,storage:!1,readWriteStorage:!1,bytes:4},stencil:{type:"uint",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:1},feature:"depth32float-stencil8",bytesPerBlock:5}}}),l=r({defaults:{blockWidth:4,blockHeight:4,multisample:!1,feature:"texture-compression-bc"},table:{"bc1-rgba-unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},baseFormat:"bc1-rgba-unorm",get bytesPerBlock(){return this.color.bytes}},"bc1-rgba-unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},baseFormat:"bc1-rgba-unorm",get bytesPerBlock(){return this.color.bytes}},"bc2-rgba-unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"bc2-rgba-unorm",get bytesPerBlock(){return this.color.bytes}},"bc2-rgba-unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"bc2-rgba-unorm",get bytesPerBlock(){return this.color.bytes}},"bc3-rgba-unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"bc3-rgba-unorm",get bytesPerBlock(){return this.color.bytes}},"bc3-rgba-unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"bc3-rgba-unorm",get bytesPerBlock(){return this.color.bytes}},"bc4-r-unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},get bytesPerBlock(){return this.color.bytes}},"bc4-r-snorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},get bytesPerBlock(){return this.color.bytes}},"bc5-rg-unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},get bytesPerBlock(){return this.color.bytes}},"bc5-rg-snorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},get bytesPerBlock(){return this.color.bytes}},"bc6h-rgb-ufloat":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},get bytesPerBlock(){return this.color.bytes}},"bc6h-rgb-float":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},get bytesPerBlock(){return this.color.bytes}},"bc7-rgba-unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"bc7-rgba-unorm",get bytesPerBlock(){return this.color.bytes}},"bc7-rgba-unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"bc7-rgba-unorm",get bytesPerBlock(){return this.color.bytes}}}}),y=r({defaults:{blockWidth:4,blockHeight:4,multisample:!1,feature:"texture-compression-etc2"},table:{"etc2-rgb8unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},baseFormat:"etc2-rgb8unorm",get bytesPerBlock(){return this.color.bytes}},"etc2-rgb8unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},baseFormat:"etc2-rgb8unorm",get bytesPerBlock(){return this.color.bytes}},"etc2-rgb8a1unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},baseFormat:"etc2-rgb8a1unorm",get bytesPerBlock(){return this.color.bytes}},"etc2-rgb8a1unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},baseFormat:"etc2-rgb8a1unorm",get bytesPerBlock(){return this.color.bytes}},"etc2-rgba8unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"etc2-rgba8unorm",get bytesPerBlock(){return this.color.bytes}},"etc2-rgba8unorm-srgb":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"etc2-rgba8unorm",get bytesPerBlock(){return this.color.bytes}},"eac-r11unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},get bytesPerBlock(){return this.color.bytes}},"eac-r11snorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:8},get bytesPerBlock(){return this.color.bytes}},"eac-rg11unorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},get bytesPerBlock(){return this.color.bytes}},"eac-rg11snorm":{color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},get bytesPerBlock(){return this.color.bytes}}}}),b=r({defaults:{multisample:!1,feature:"texture-compression-astc"},table:{"astc-4x4-unorm":{blockWidth:4,blockHeight:4,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-4x4-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-4x4-unorm-srgb":{blockWidth:4,blockHeight:4,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-4x4-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-5x4-unorm":{blockWidth:5,blockHeight:4,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-5x4-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-5x4-unorm-srgb":{blockWidth:5,blockHeight:4,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-5x4-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-5x5-unorm":{blockWidth:5,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-5x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-5x5-unorm-srgb":{blockWidth:5,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-5x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-6x5-unorm":{blockWidth:6,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-6x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-6x5-unorm-srgb":{blockWidth:6,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-6x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-6x6-unorm":{blockWidth:6,blockHeight:6,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-6x6-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-6x6-unorm-srgb":{blockWidth:6,blockHeight:6,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-6x6-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-8x5-unorm":{blockWidth:8,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-8x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-8x5-unorm-srgb":{blockWidth:8,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-8x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-8x6-unorm":{blockWidth:8,blockHeight:6,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-8x6-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-8x6-unorm-srgb":{blockWidth:8,blockHeight:6,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-8x6-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-8x8-unorm":{blockWidth:8,blockHeight:8,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-8x8-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-8x8-unorm-srgb":{blockWidth:8,blockHeight:8,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-8x8-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x5-unorm":{blockWidth:10,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x5-unorm-srgb":{blockWidth:10,blockHeight:5,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x5-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x6-unorm":{blockWidth:10,blockHeight:6,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x6-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x6-unorm-srgb":{blockWidth:10,blockHeight:6,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x6-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x8-unorm":{blockWidth:10,blockHeight:8,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x8-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x8-unorm-srgb":{blockWidth:10,blockHeight:8,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x8-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x10-unorm":{blockWidth:10,blockHeight:10,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x10-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-10x10-unorm-srgb":{blockWidth:10,blockHeight:10,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-10x10-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-12x10-unorm":{blockWidth:12,blockHeight:10,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-12x10-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-12x10-unorm-srgb":{blockWidth:12,blockHeight:10,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-12x10-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-12x12-unorm":{blockWidth:12,blockHeight:12,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-12x12-unorm",get bytesPerBlock(){return this.color.bytes}},"astc-12x12-unorm-srgb":{blockWidth:12,blockHeight:12,color:{type:"float",copySrc:!0,copyDst:!0,storage:!1,readWriteStorage:!1,bytes:16},baseFormat:"astc-12x12-unorm",get bytesPerBlock(){return this.color.bytes}}}}),n={...l,...y,...b},i={...s,...n},g={...s,...c},p={...s,...c,...n},u={...c,...a},m={...s,...c,...a},d={...m,...n},h=t(s);t(c),t(a),t(n),t(l),t(b),t(i),t(g),t(p),t(u),t(m),t(d);const S={...s,...c,...a,...l,...y,...b};h.filter((e=>i[e].renderable));const f=Symbol("webgpu-memory-object-id"),k=new Map;let P=1;const W=new Map;let D=0,B=0;function x(e,t,o,r){let s=t[f];s||(s=P++,t[f]=s);const c=e[f],a={ref:new WeakRef(t),id:s,deviceId:c,category:o,size:r};if(W.set(s,a),"function"==typeof r&&(r=r(t),a.oldSize=r),!isNaN(r)){v(W.get(c),r)}}function v(e,t){e.runningTotal=(e.runningTotal??0)+t,e.maxTotal=Math.max(e.maxTotal??0,e.runningTotal),D+=t,B=Math.max(B,D)}function C(e,t,o,r){x(e,t,o,r)}function F(e){const t=k.get(e);return t&&!!t.deref()}function R(e,t){const o=W.get(e);let r=o?.size;if(t&&"function"==typeof r&&(r=r(t)),!isNaN(r)){const e=W.get(o.deviceId);e&&v(e,-r)}W.delete(e)}function G(e){R(e[f],e)}function H(e){const t={total:0,buffer:0,texture:0,querySet:0,canvas:0,maxTotal:0},o={buffer:0,texture:0,querySet:0},r={memory:t,resources:o},s=e&&e[f],c=[];for(const[e,{ref:r,deviceId:a,category:l,size:y,maxTotal:b}]of W.entries()){const n=r.deref();if(n&&F(a)){if(!s||a===s){if(o[l]=(o[l]||0)+1,y){const e="function"==typeof y?y(n):y;t.total+=e,t[l]+=e}"device"===l&&(t.maxTotal+=b)}}else c.push(e)}return e||(t.maxTotal=B),c.forEach((e=>R(e))),r}function U(e){const{blockWidth:t,blockHeight:o,bytesPerBlock:r}=S[e.format];let s=0,c=e.width,a=e.height,l=e.depthOrArrayLayers;for(let y=0;y<e.mipLevelCount;++y){s+=Math.ceil(c*e.sampleCount/t)*Math.ceil(a*e.sampleCount/o)*l*r,c=Math.max(1,c/2|0),a=Math.max(1,a/2|0),l="3d"===e.dimension?Math.max(1,l/2|0):l}return s}function T(e,t,o){const r=e.prototype[t];e.prototype[t]=function(...e){const t=r.call(this,...e);return void 0!==t&&"function"==typeof t.then?t.then((t=>o(this,t,...e))):o(this,t,...e),t}}const M=2;function L(e,t,o,r){T(e,o,(function(e,t){x(e,t,r)})),t.prototype.destroy&&T(t,"destroy",(function(e){G(e)}))}"undefined"!=typeof GPUAdapter&&(T(GPUAdapter,"requestDevice",(function(e,t){C(t,t,"device",0);const o=t[f];k.set(o,new WeakRef(t))})),T(GPUDevice,"destroy",(function(e){const t=e[f];k.delete(t),G(e)})),T(GPUCanvasContext,"configure",(function(e,t,o){G(e);const r=o.format;C(o.device,e,"canvas",(e=>function(e,t){const{width:o,height:r}=e.canvas;return U({format:t,width:o,height:r,depthOrArrayLayers:1,sampleCount:1,mipLevelCount:1,dimension:"2d"})*M}(e,r)))})),T(GPUCanvasContext,"unconfigure",(function(e){G(e)})),T(GPUCanvasContext,"getCurrentTexture",(function(e){const t=e[f],o=W.get(t),r=W.get(o.deviceId);v(r,-o.oldSize);const s=o.size(e);o.oldSize=s,v(r,s)})),T(GPUDevice,"createBuffer",(function(e,t){C(e,t,"buffer",t.size)})),T(GPUBuffer,"destroy",(function(e){G(e)})),T(GPUDevice,"createTexture",(function(e,t){C(e,t,"texture",U(t))})),T(GPUTexture,"destroy",(function(e){G(e)})),T(GPUDevice,"createQuerySet",(function(e,t){C(e,t,"querySet",8*t.count)})),T(GPUQuerySet,"destroy",(function(e){G(e)})),L(GPUDevice,GPUSampler,"createSampler","sampler"),L(GPUDevice,GPUBindGroup,"createBindGroup","bindGroup"),L(GPUDevice,GPUBindGroupLayout,"createBindGroupLayout","bindGroupLayout"),L(GPUDevice,GPUPipelineLayout,"createPipelineLayout","pipelineLayout"),L(GPUDevice,GPUShaderModule,"createShaderModule","shaderModule"),L(GPUDevice,GPUComputePipeline,"createComputePipeline","computePipeline"),L(GPUDevice,GPURenderPipeline,"createRenderPipeline","renderPipeline"),L(GPUDevice,GPUComputePipeline,"createComputePipelineAsync","computePipeline"),L(GPUDevice,GPURenderPipeline,"createRenderPipelineAsync","renderPipeline")),e.getWebGPUMemoryUsage=H,e.resetMaxTotal=function(e){const t=e?[e]:[];let o=0;if(!e)for(const[e,{ref:o,category:r}]of W.entries())if("device"===r){const e=o.deref();t.push(e)}for(const e of t){const t=H(e),r=e[f],s=W.get(r);if(s){const{total:e}=t.memory;s.maxTotal=e,o+=e}}e||(D=o,B=o)}}));
//# sourceMappingURL=webgpu-memory.min.js.map
